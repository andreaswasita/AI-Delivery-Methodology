{
  "name": "pol-deny-fa-app-slot-public-network-access",
  "properties": {
    "displayName": "Public network access should be disabled for App Service and Function App slots",
    "mode": "Indexed",
    "description": "Disabling public network access improves security by ensuring that the App Service is not exposed on the public internet. Creating private endpoints can limit exposure of an App Service. Learn more at: https://aka.ms/app-service-private-endpoint.",
    "metadata": {
      "version": "1.0.0",
      "category": "App Service",
      "preview": false,
      "deprecated": false
    },
    "parameters": {
      "effect": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "'Audit' allows a non-compliant resource to be created, but flags it as non-compliant. 'Deny' blocks the resource creation. 'Disable' turns off the policy."
        },
        "allowedValues": [
          "Audit",
          "Disabled",
          "Deny"
        ],
        "defaultValue": "Deny"
      }
    },
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.Web/sites/slots"
          },
          {
            "anyOf": [
              {
                "field": "Microsoft.Web/sites/slots/publicNetworkAccess",
                "exists": "false"
              },
              {
                "field": "Microsoft.Web/sites/slots/publicNetworkAccess",
                "notEquals": "Disabled"
              }
            ]
          }
        ]
      },
      "then": {
        "effect": "[parameters('effect')]"
      }
    }
  }
}
