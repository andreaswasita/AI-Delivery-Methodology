{
  "name": "pol-audit-deny-redis-enable-only-secure-connections",
  "properties": {
    "displayName": "Only secure connections to your Azure Cache for Redis should be enabled",
    "description": "Deny connections to Azure Cache for Redis if not via SSL. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.",
    "metadata": {
      "category": "Data Protection",
      "version": "1.0.0",
      "preview": false,
      "deprecated": false,
      "source_builtIn_name": "22bee202-a82f-4305-9a2a-6d7f44d4dedb"
    },
    "mode": "Indexed",
    "parameters": {
      "effect": {
        "type": "string",
        "defaultValue": "Deny",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Effect",
          "description": "The effect determines what happens when the policy rule is evaluated to match"
        }
      }
    },
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.Cache/redis"
          },
          {
            "field": "Microsoft.Cache/Redis/enableNonSslPort",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "[parameters('effect')]"
      }
    }
  }
}
